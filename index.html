<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Special Surprise</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            overflow-x: hidden;
            touch-action: manipulation; /* Improves touch response */
        }
        
        .script-font {
            font-family: 'Great Vibes', cursive;
        }

        /* Smooth section transitions */
        .section {
            transition: opacity 1s ease-in-out, transform 0.8s ease;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            z-index: 0;
        }

        .section.active {
            opacity: 1;
            pointer-events: auto;
            z-index: 10;
            position: relative;
        }

        /* Custom glow effect */
        .glow-text {
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.7), 0 0 20px rgba(255, 255, 255, 0.5);
        }

        /* Balloon Animation */
        .balloon {
            position: absolute;
            bottom: -100px;
            width: 50px;
            height: 65px;
            border-radius: 50%;
            background-color: #ff6b6b;
            animation: floatUp 6s ease-in infinite;
            z-index: 1;
            opacity: 0.8;
        }
        .balloon::before {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 40px;
            background: rgba(255,255,255,0.5);
        }

        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            100% { transform: translateY(-110vh) rotate(20deg); opacity: 0; }
        }

        /* Cake CSS Art */
        .cake-container {
            position: relative;
            width: 250px;
            height: 200px;
            margin-top: 2rem;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .cake-container:hover {
            transform: scale(1.02);
        }

        .plate {
            width: 270px;
            height: 10px;
            background: #e0e0e0;
            border-radius: 10px;
            position: absolute;
            bottom: 0;
            left: -10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .layer {
            position: absolute;
            width: 200px;
            left: 25px;
            border-radius: 10px;
        }

        .layer-bottom {
            height: 80px;
            bottom: 10px;
            background: #f8b4b4; /* Pink */
            border-bottom: 5px solid #d48787;
        }

        .layer-middle {
            height: 70px;
            bottom: 90px;
            background: #fcd5ce; /* Lighter Pink */
            width: 180px;
            left: 35px;
            border-bottom: 5px solid #e0a3a3;
        }

        .layer-top {
            height: 60px;
            bottom: 160px;
            background: #ffe5d9; /* Cream */
            width: 160px;
            left: 45px;
            border-bottom: 5px solid #e6c2c2;
        }

        .icing {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 15px;
            background: #fff;
            border-radius: 10px 10px 5px 5px;
        }
        
        .drip {
            width: 15px;
            height: 25px;
            background: #fff;
            border-radius: 0 0 10px 10px;
            position: absolute;
            top: 10px;
        }

        .candle {
            position: absolute;
            width: 12px;
            height: 40px;
            background: repeating-linear-gradient(45deg, #fff, #fff 5px, #ff6b6b 5px, #ff6b6b 10px);
            bottom: 220px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 4px;
            z-index: 5;
        }

        .flame {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 14px;
            height: 20px;
            background: #ff9f43;
            border-radius: 50% 50% 20% 20%;
            box-shadow: 0 0 10px #ff9f43, 0 0 20px #ff9f43;
            animation: flicker 1s infinite alternate;
        }

        @keyframes flicker {
            0% { transform: translateX(-50%) scale(1); opacity: 0.9; }
            100% { transform: translateX(-50%) scale(1.1); opacity: 1; }
        }

        /* Knife Animation */
        .knife {
            position: absolute;
            top: 0;
            right: -50px;
            font-size: 80px;
            transform: rotate(-45deg);
            opacity: 0;
            transition: all 1s ease;
            pointer-events: none;
            z-index: 20;
        }

        .cutting .knife {
            opacity: 1;
            top: 50px;
            right: 80px;
            transform: rotate(-90deg) translateY(50px);
        }

        .cut-slice {
            transform: translateX(-20px) rotate(-5deg);
            transition: transform 1s ease 1s; /* Delay for knife */
        }

        /* Final Card */
        .card-container {
            perspective: 1000px;
            opacity: 0;
            transform: scale(0.8);
            transition: all 1s ease;
        }
        .card-container.visible {
            opacity: 1;
            transform: scale(1);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

    </style>
</head>
<body class="bg-slate-900 text-white min-h-screen transition-colors duration-1000 ease-in-out" id="mainBody">

    <!-- Container for balloons -->
    <div id="decoration-container" class="absolute inset-0 pointer-events-none overflow-hidden"></div>

    <!-- AUDIO Placeholder (Optional) -->
    <!-- <audio id="bgMusic" loop>
        <source src="your-music-link.mp3" type="audio/mpeg">
    </audio> -->

    <!-- STEP 1: HOME -->
    <div id="step1" class="section active min-h-screen px-6">
        <div class="max-w-md text-center space-y-8">
            <h1 class="text-3xl md:text-5xl font-light leading-relaxed text-gray-300">
                Why just a single text message?
            </h1>
            <p class="text-xl md:text-2xl text-purple-300 animate-pulse">
                Here's something special for you...
            </p>
            <button onclick="nextStep(2)" class="mt-8 px-8 py-4 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full text-xl font-bold shadow-lg transform transition hover:scale-105 hover:shadow-purple-500/50 focus:outline-none ring-4 ring-purple-500/30">
                I am excited! 
            </button>
        </div>
    </div>

    <!-- STEP 2: GREETING -->
    <div id="step2" class="section min-h-screen px-6">
        <div class="max-w-lg text-center space-y-6">
            <h1 class="script-font text-6xl md:text-8xl text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-pink-400 to-yellow-200 animate-gradient">
                Happy Birthday!
            </h1>
            <h2 class="text-2xl md:text-4xl font-light text-white">
                To my amazing friend
            </h2>
            <p class="text-gray-300 text-lg md:text-xl italic mt-4">
                Today is all about you. Let's make it memorable.
            </p>
            <div class="pt-8">
                <button onclick="nextStep(3)" class="px-8 py-3 bg-white text-purple-900 rounded-full font-bold shadow-lg hover:bg-gray-100 transition transform hover:-translate-y-1">
                    Thanks! Show me more &rarr;
                </button>
            </div>
        </div>
    </div>

    <!-- STEP 3: INTERACTIVE ROOM -->
    <div id="step3" class="section min-h-screen px-4">
        <div class="w-full max-w-md flex flex-col items-center justify-center space-y-6 relative z-10">
            
            <!-- Dynamic Instruction Text -->
            <p id="instruction-text" class="text-xl text-center text-gray-300 mb-4 h-16 flex items-center justify-center">
                It's a little dark in here...
            </p>

            <!-- Button Group -->
            <div class="space-y-4 w-full flex flex-col items-center">
                
                <!-- 1. Lights -->
                <button id="btn-lights" onclick="toggleLights()" class="w-64 py-3 bg-yellow-600/80 hover:bg-yellow-500 rounded-xl font-semibold shadow-lg transition-all border border-yellow-400/30">
                    ðŸ’¡ Turn on Lights
                </button>

                <!-- 2. Decorations (Hidden initially) -->
                <button id="btn-decor" onclick="addDecorations()" class="hidden w-64 py-3 bg-pink-600/80 hover:bg-pink-500 rounded-xl font-semibold shadow-lg transition-all border border-pink-400/30">
                    ðŸŽˆ Add Decorations
                </button>

                <!-- 3. Cake (Hidden initially) -->
                <button id="btn-cake" onclick="showCake()" class="hidden w-64 py-3 bg-purple-600/80 hover:bg-purple-500 rounded-xl font-semibold shadow-lg transition-all border border-purple-400/30">
                    ðŸŽ‚ Bring the Cake
                </button>
            </div>

            <!-- Cake Display Area -->
            <div id="cake-display" class="hidden relative mt-8 transition-opacity duration-1000 opacity-0">
                <div class="cake-container" onclick="cutCake()">
                    <!-- Knife (Emoji for simplicity and animation) -->
                    <div class="knife">ðŸ”ª</div>
                    
                    <div class="candle">
                        <div class="flame"></div>
                    </div>
                    
                    <!-- Cake Layers -->
                    <div class="layer layer-top">
                        <div class="icing"></div>
                        <div class="drip" style="left: 20px;"></div>
                        <div class="drip" style="left: 60px; height: 15px;"></div>
                        <div class="drip" style="left: 100px;"></div>
                    </div>
                    <div class="layer layer-middle"></div>
                    <div class="layer layer-bottom"></div>
                    <div class="plate"></div>
                </div>
            </div>

        </div>
    </div>

    <!-- STEP 4: FINAL CARD (Overlay) -->
    <div id="step4" class="fixed inset-0 flex items-center justify-center z-50 pointer-events-none opacity-0 transition-opacity duration-1000 bg-black/60 backdrop-blur-sm">
        <div class="card-container relative w-11/12 max-w-md p-8 glass-card rounded-2xl text-center">
            
            <!-- Decorative Header -->
            <div class="absolute -top-6 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-pink-500 to-purple-500 text-white px-6 py-2 rounded-full shadow-lg">
                <span class="script-font text-2xl">Best Wishes</span>
            </div>

            <div class="mt-6 space-y-4">
                <h3 class="text-3xl font-bold text-gray-800 script-font">For a Wonderful Soul</h3>
                <p class="text-gray-700 leading-relaxed text-sm md:text-base text-justify">
                    On this special day, I wish you a year filled with as much happiness as you bring to everyone around you. 
                    May your future be bright, your dreams big, and your worries small. 
                    Keep shining, keep smiling, and never forget how amazing you are.
                </p>
                <div class="py-4">
                    <p class="text-pink-600 font-bold">Happy Birthday!</p>
                </div>
                <button onclick="restart()" class="text-xs text-gray-400 hover:text-gray-600 underline">
                    Replay Surprise
                </button>
            </div>
        </div>
    </div>

    <script>
        // State Management
        let currentStep = 1;
        
        function nextStep(step) {
            // Hide current
            document.getElementById(`step${currentStep}`).classList.remove('active');
            
            // Show next
            currentStep = step;
            const nextEl = document.getElementById(`step${currentStep}`);
            nextEl.classList.add('active');
            nextEl.style.display = 'flex'; // Ensure flex layout is kept
            
            // Special trigger for confetti on Step 2
            if (step === 2) {
                launchConfetti();
            }
        }

        // --- Step 3 Interactions ---

        function toggleLights() {
            const body = document.getElementById('mainBody');
            const instructions = document.getElementById('instruction-text');
            const btnLights = document.getElementById('btn-lights');
            const btnDecor = document.getElementById('btn-decor');

            // Change background to a warm radial gradient
            body.classList.remove('bg-slate-900');
            body.style.background = "radial-gradient(circle at center, #2e1065, #0f172a)"; // Deep purple warm dark
            
            // Add glow to elements
            instructions.classList.add('glow-text');
            instructions.textContent = "Much better! Now let's set the mood.";
            
            // Update buttons
            btnLights.classList.add('hidden');
            btnDecor.classList.remove('hidden');
            
            // Soft global confetti (dust/light)
            confetti({
                particleCount: 50,
                spread: 100,
                origin: { y: 0.6 },
                colors: ['#FFD700', '#FFA500'],
                scalar: 0.8,
                drift: 0.5
            });
        }

        function addDecorations() {
            const instructions = document.getElementById('instruction-text');
            const btnDecor = document.getElementById('btn-decor');
            const btnCake = document.getElementById('btn-cake');
            const container = document.getElementById('decoration-container');

            instructions.textContent = "Beautiful! But something is missing...";
            
            // Generate balloons
            const colors = ['#ff7675', '#74b9ff', '#55efc4', '#a29bfe', '#fd79a8'];
            for(let i=0; i<15; i++) {
                const b = document.createElement('div');
                b.className = 'balloon';
                b.style.left = Math.random() * 100 + '%';
                b.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                b.style.animationDelay = Math.random() * 5 + 's';
                container.appendChild(b);
            }

            // Fire confetti cannons from sides
            const duration = 3000;
            const end = Date.now() + duration;

            (function frame() {
                confetti({
                    particleCount: 5,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    colors: colors
                });
                confetti({
                    particleCount: 5,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    colors: colors
                });

                if (Date.now() < end) {
                requestAnimationFrame(frame);
                }
            }());

            btnDecor.classList.add('hidden');
            btnCake.classList.remove('hidden');
        }

        function showCake() {
            const instructions = document.getElementById('instruction-text');
            const btnCake = document.getElementById('btn-cake');
            const cakeDisplay = document.getElementById('cake-display');

            instructions.textContent = "Make a wish and click the cake!";
            instructions.classList.add('text-pink-300', 'font-bold');

            btnCake.classList.add('hidden');
            cakeDisplay.classList.remove('hidden');
            
            // Fade in cake
            setTimeout(() => {
                cakeDisplay.classList.remove('opacity-0');
            }, 100);
        }

        let cakeCut = false;
        function cutCake() {
            if(cakeCut) return;
            cakeCut = true;

            const instructions = document.getElementById('instruction-text');
            instructions.textContent = "Yum! ðŸ°";
            
            const cakeContainer = document.querySelector('.cake-container');
            
            // Trigger knife animation via class
            cakeContainer.classList.add('cutting');

            // Play celebratory confetti
            setTimeout(() => {
                launchConfetti();
                // Simulate Slice moving (visual trick)
                // We're keeping it simple with CSS animations
            }, 800);

            // Show Final Card after delay
            setTimeout(() => {
                showFinalCard();
            }, 2500);
        }

        function showFinalCard() {
            const step4 = document.getElementById('step4');
            const card = step4.querySelector('.card-container');
            
            step4.style.pointerEvents = "auto";
            step4.style.opacity = "1";
            card.classList.add('visible');
        }

        function launchConfetti() {
            var duration = 3 * 1000;
            var animationEnd = Date.now() + duration;
            var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            var random = Math.random;

            (function frame() {
            var timeLeft = animationEnd - Date.now();

            if (timeLeft <= 0) {
                return;
            }

            var particleCount = 20 * (timeLeft / duration);
            confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomRange(0.1, 0.3), y: Math.random() - 0.2 } }));
            confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomRange(0.7, 0.9), y: Math.random() - 0.2 } }));

            requestAnimationFrame(frame);
            }());
        }
        
        function randomRange(min, max) {
             return Math.random() * (max - min) + min;
        }

        function restart() {
            location.reload();
        }
    </script>
</body>
</html>

