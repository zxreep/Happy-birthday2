<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday Special</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Pacifico (Playful), Great Vibes (Elegant), Nunito (Soft Body) -->
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Nunito:wght@400;600;700&family=Pacifico&display=swap" rel="stylesheet">
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        /* --- Typography & Theme --- */
        :root {
            --primary-pink: #FF9AA2;
            --primary-purple: #C7CEEA;
            --soft-cream: #FFF5E1;
        }

        body {
            font-family: 'Nunito', sans-serif;
            overflow-x: hidden;
            touch-action: manipulation;
            background-color: #2d3436; /* Soft Dark Start */
            color: white;
            transition: background 1.5s ease;
        }
        .script-font {
            font-family: 'Great Vibes', cursive;
        }
        .font-playful {
            font-family: 'Pacifico', cursive;
            letter-spacing: 1px;
        }

        .font-elegant {
            font-family: 'Great Vibes', cursive;
        }

        /* --- Layout & Transitions --- */
        .section {
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            width: 100%;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 0.6s ease-in-out;
            padding: 1.5rem;
            text-align: center;
        }

        .section.active {
            display: flex;
            opacity: 1;
            z-index: 10;
            position: relative;
        }

        /* --- Decorative Buntings --- */
        .bunting-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 80px;
            z-index: 5;
            pointer-events: none;
            display: flex;
            justify-content: center;
            gap: 10px;
            opacity: 0;
            transform: translateY(-50px);
            transition: all 1s ease;
        }
        
        .bunting-container.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .flag {
            width: 30px;
            height: 40px;
            background: red;
            clip-path: polygon(0 0, 100% 0, 50% 100%);
            transform-origin: top center;
            animation: sway 3s ease-in-out infinite alternate;
        }
        
        .flag:nth-child(odd) { animation-duration: 3.2s; background: #ff7675; }
        .flag:nth-child(even) { animation-duration: 2.5s; background: #74b9ff; }
        .flag:nth-child(3n) { background: #ffeaa7; }

        @keyframes sway {
            0% { transform: rotate(8deg); }
            100% { transform: rotate(-8deg); }
        }

        /* --- Stickers --- */
        .sticker {
            position: absolute;
            font-size: 2.5rem;
            opacity: 0;
            transform: scale(0);
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));
        }
        .sticker.show {
            opacity: 1;
            transform: scale(1) rotate(var(--r));
        }

        /* --- Balloon Game --- */
        .game-balloon {
            width: 50px;
            height: 65px;
            background-color: #ff7675;
            border-radius: 50%;
            position: absolute;
            cursor: pointer;
            transition: transform 0.2s;
            animation: floatGame 3s ease-in-out infinite alternate;
            box-shadow: inset -5px -5px 10px rgba(0,0,0,0.1);
        }
        .game-balloon::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 25px;
            background: rgba(255,255,255,0.6);
        }
        .game-balloon:active { transform: scale(0.9); }
        
        @keyframes floatGame {
            0% { transform: translateY(0); }
            100% { transform: translateY(-15px); }
        }

        .pop-animation {
            animation: pop 0.2s forwards;
        }
        @keyframes pop {
            to { transform: scale(1.5); opacity: 0; }
        }

        /* --- Cake Art (Refined) --- */
        .cake-container {
            position: relative;
            width: 250px;
            height: 200px;
            margin-top: 2rem;
            cursor: pointer;
            transition: transform 0.3s;
        }
        .cake-container:hover { transform: scale(1.02); }

        .plate {
            width: 270px; height: 12px; background: #dfe6e9;
            border-radius: 10px; position: absolute; bottom: 0; left: -10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .layer { position: absolute; width: 200px; left: 25px; border-radius: 8px; }
        
        .layer-bottom { height: 80px; bottom: 12px; background: #fab1a0; border-bottom: 6px solid #e17055; }
        .layer-middle { height: 70px; bottom: 92px; background: #ffeaa7; width: 180px; left: 35px; border-bottom: 6px solid #fdcb6e; }
        .layer-top { height: 60px; bottom: 162px; background: #ff7675; width: 160px; left: 45px; border-bottom: 6px solid #d63031; }
        
        .icing { position: absolute; top: 0; left: 0; width: 100%; height: 20px; background: #fff; border-radius: 8px 8px 5px 5px; opacity: 0.9; }
        .drip { width: 15px; height: 25px; background: #fff; border-radius: 0 0 10px 10px; position: absolute; top: 10px; }
        
        .candle {
            position: absolute; width: 10px; height: 35px;
            background: repeating-linear-gradient(45deg, #fff, #fff 4px, #74b9ff 4px, #74b9ff 8px);
            bottom: 222px; left: 50%; transform: translateX(-50%);
            border-radius: 3px; z-index: 5;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .flame {
            position: absolute; top: -18px; left: 50%; transform: translateX(-50%);
            width: 12px; height: 18px; background: #fdcb6e;
            border-radius: 50% 50% 20% 20%;
            box-shadow: 0 0 10px #fdcb6e, 0 0 20px #e17055;
            animation: flicker 0.8s infinite alternate;
        }
        @keyframes flicker { 0% { opacity: 0.8; transform: translateX(-50%) scale(0.9); } 100% { opacity: 1; transform: translateX(-50%) scale(1.1); } }

        .knife {
            position: absolute; top: 0; right: -50px; font-size: 70px;
            transform: rotate(-45deg); opacity: 0; transition: all 0.8s ease;
            pointer-events: none; z-index: 20; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.2));
        }
        .cutting .knife { opacity: 1; top: 40px; right: 80px; transform: rotate(-90deg) translateY(40px); }

        /* --- Glass Card --- */
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            border: 2px solid rgba(255, 255, 255, 0.8);
            border-radius: 24px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
        }

        /* --- Quiz Animations --- */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-8px); }
            40% { transform: translateX(8px); }
            60% { transform: translateX(-4px); }
            80% { transform: translateX(4px); }
        }
        .shake-it { animation: shake 0.4s ease-in-out; }

    </style>
</head>
<body id="main-body" class="bg-slate-800 text-slate-100 min-h-screen flex items-center justify-center">

    <!-- Decoration Layer -->
    <div id="bunting" class="bunting-container">
        <!-- Generated via JS for cleaner code -->
    </div>
    <div id="sticker-container" class="fixed inset-0 pointer-events-none overflow-hidden z-0"></div>

    <!-- STEP 1: Intro -->
    <div id="step-1" class="section active bg-slate-800">
        <div class="max-w-md w-full space-y-6">
            <h1 class="text-3xl md:text-5xl leading-tight text-pink-200">
                <span class="font-light block text-2xl mb-2 text-white">Why just a simple text?</span>
                <span class="script-font text-pink-300">Here is something special...</span>
            </h1>
            
            <div class="py-8">
                <button onclick="goToQuiz()" class="group relative px-8 py-4 bg-white text-pink-500 rounded-full text-xl font-bold shadow-xl transition transform hover:scale-105 hover:shadow-2xl overflow-hidden">
                    <span class="relative z-10">I am Excited! ‚ú®</span>
                    <div class="absolute inset-0 bg-pink-50 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-300"></div>
                </button>
            </div>
        </div>
    </div>

    <!-- STEP 2: The Quiz (Lovely Theme) -->
    <div id="step-quiz" class="section bg-slate-700">
        <div class="w-full max-w-md bg-white/10 backdrop-blur-md p-8 rounded-3xl border border-white/20 shadow-2xl">
            <div class="text-center mb-6">
                <span class="text-4xl">üîê</span>
                <h2 class="text-2xl font-playful text-pink-300 mt-2">Vibe Check</h2>
            </div>
            
            <!-- Q1 -->
            <div id="q1" class="quiz-q space-y-6">
                <p class="text-xl font-semibold text-white">Who is the birthday queen today?</p>
                <div class="flex flex-col gap-3">
                    <button onclick="wrongAnswer(this)" class="w-full py-3 rounded-xl bg-slate-600 hover:bg-slate-500 transition font-medium text-slate-200">
                        Some random person
                    </button>
                    <button onclick="nextQuestion('q1', 'q2')" class="w-full py-3 rounded-xl bg-gradient-to-r from-pink-400 to-rose-400 text-white font-bold shadow-lg transform transition hover:scale-105">
                        ME! (Obviously) üíÅ‚Äç‚ôÄÔ∏è
                    </button>
                </div>
            </div>

            <!-- Q2 -->
            <div id="q2" class="quiz-q hidden space-y-6">
                <p class="text-xl font-semibold text-white">What is the rule for today?</p>
                <div class="flex flex-col gap-3">
                    <button id="btn-sad" onclick="transformButton(this)" class="w-full py-3 rounded-xl border border-pink-300 text-pink-200 hover:bg-pink-900/30 transition">
                        Worry about work/studies
                    </button>
                    <button onclick="nextQuestion('q2', 'q3')" class="w-full py-3 rounded-xl bg-gradient-to-r from-yellow-400 to-orange-400 text-white font-bold shadow-lg transform transition hover:scale-105">
                        Smile & Shine! ‚ú®
                    </button>
                </div>
            </div>

            <!-- Q3 -->
            <div id="q3" class="quiz-q hidden space-y-6">
                <p class="text-xl font-semibold text-white">Are you ready for your surprise?</p>
                <button onclick="finishQuiz()" class="w-full py-4 rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold text-lg shadow-xl transform transition hover:scale-105 hover:shadow-purple-500/40">
                    YES, SHOW ME! üöÄ
                </button>
            </div>
        </div>
    </div>

    <!-- STEP 3: Greeting (Elegant) -->
    <div id="step-greeting" class="section bg-gradient-to-br from-indigo-900 via-purple-900 to-slate-900">
        <div class="text-center space-y-6 px-4">
            <h1 class="font-elegant text-7xl md:text-9xl text-transparent bg-clip-text bg-gradient-to-r from-pink-300 via-purple-200 to-pink-300 drop-shadow-lg leading-tight p-2">
                Happy Birthday
            </h1>
            <p class="text-xl md:text-2xl text-pink-100 font-light tracking-wide">
                To the most beautiful soul...
            </p>
            <div class="pt-10">
                <button onclick="enterRoom()" class="px-10 py-3 bg-white text-purple-900 rounded-full font-bold shadow-xl hover:bg-pink-50 hover:text-pink-600 transition-all duration-300 transform hover:-translate-y-1">
                    Enter Party Room üéâ
                </button>
            </div>
        </div>
    </div>

    <!-- STEP 4: Interactive Room -->
    <div id="step-room" class="section">
        <div class="relative z-10 w-full max-w-md flex flex-col items-center gap-6">
            
            <!-- Message Box -->
            <div class="h-16 flex items-center justify-center">
                <p id="room-msg" class="text-xl font-playful text-center text-slate-200 transition-colors duration-500">
                    It's a little dark in here...
                </p>
            </div>

            <!-- Action Area -->
            <div class="w-full flex justify-center min-h-[60px]">
                
                <!-- 1. Lights -->
                <button id="btn-lights" onclick="turnOnLights()" class="w-64 py-3 bg-yellow-400 hover:bg-yellow-300 text-yellow-900 rounded-2xl font-bold shadow-lg transition transform hover:-translate-y-1">
                    üí° Turn On Lights
                </button>

                <!-- 2. Decor -->
                <button id="btn-decor" onclick="decorateRoom()" class="hidden w-64 py-3 bg-pink-400 hover:bg-pink-300 text-white rounded-2xl font-bold shadow-lg transition transform hover:-translate-y-1">
                    üéÄ Add Decorations
                </button>

                <!-- 4. Cake -->
                <button id="btn-cake" onclick="summonCake()" class="hidden w-64 py-3 bg-purple-500 hover:bg-purple-400 text-white rounded-2xl font-bold shadow-lg transition transform hover:-translate-y-1">
                    üéÇ Bring the Cake
                </button>
            </div>

            <!-- 3. Mini Game -->
            <div id="game-area" class="hidden w-full h-48 relative border-2 border-dashed border-pink-300/30 rounded-2xl bg-white/5 mt-4">
                <p class="absolute top-2 w-full text-center text-xs text-pink-400 font-bold uppercase tracking-widest opacity-70">Tap 5 Balloons</p>
                <div id="balloons-container" class="absolute inset-0 overflow-hidden rounded-2xl"></div>
            </div>
            
            <!-- 5. Actual Cake Stage -->
            <div id="cake-stage" class="hidden opacity-0 transition-opacity duration-1000 mt-4 flex flex-col items-center">
                <div class="cake-container" onclick="cutCake()">
                    <div class="knife">üî™</div>
                    <div class="candle"><div class="flame"></div></div>
                    <div class="layer layer-top">
                        <div class="icing"></div>
                        <div class="drip" style="left:20px"></div><div class="drip" style="left:60px; height:18px"></div><div class="drip" style="left:100px"></div>
                    </div>
                    <div class="layer layer-middle"></div>
                    <div class="layer layer-bottom"></div>
                    <div class="plate"></div>
                </div>
                <p class="mt-8 text-pink-400 font-bold animate-bounce cursor-pointer">Tap the cake to cut!</p>
            </div>

        </div>
    </div>

    <!-- STEP 5: Final Card -->
    <div id="final-card" class="fixed inset-0 flex items-center justify-center z-50 bg-black/40 backdrop-blur-sm opacity-0 pointer-events-none transition-opacity duration-1000 p-6">
        <div class="glass-card w-full max-w-sm p-8 text-center transform scale-95 transition-transform duration-700" id="card-inner">
            
            <!-- Card Decor -->
            <div class="absolute -top-6 left-1/2 transform -translate-x-1/2 bg-white rounded-full p-3 shadow-lg">
                <span class="text-3xl">üéÅ</span>
            </div>

            <h2 class="font-playful text-3xl text-pink-500 mb-6 mt-4">Best Wishes!</h2>
            
            <div class="text-slate-600 space-y-4 text-sm md:text-base leading-relaxed font-medium">
                <p>
                    Here's to a year filled with sweet moments, colorful surprises, and endless joy.
                </p>
                <p>
                    May you always find reasons to smile, and may your dreams be as bright as the candles on your cake.
                </p>
                <p class="text-pink-500 font-bold">You are amazing!</p>
            </div>

            <div class="mt-8 pt-4 border-t border-pink-100">
                <p class="font-elegant text-3xl text-purple-400">Happy Birthday</p>
            </div>
            
            <button onclick="location.reload()" class="mt-6 px-4 py-1 rounded-full border border-slate-300 text-xs text-slate-400 hover:bg-slate-50 hover:text-slate-600 transition">
                Replay Surprise
            </button>
        </div>
    </div>

    <script>
        // --- Setup Decorations (Run once) ---
        const buntingContainer = document.getElementById('bunting');
        for(let i=0; i<12; i++) {
            const flag = document.createElement('div');
            flag.className = 'flag';
            buntingContainer.appendChild(flag);
        }

        // --- Navigation ---
        function switchSection(hideId, showId) {
            const hideEl = document.getElementById(hideId);
            const showEl = document.getElementById(showId);
            
            hideEl.classList.remove('active');
            setTimeout(() => {
                hideEl.style.display = 'none';
                showEl.style.display = 'flex';
                setTimeout(() => showEl.classList.add('active'), 50);
            }, 500);
        }

        function goToQuiz() { switchSection('step-1', 'step-quiz'); }

        // --- Quiz Logic ---
        function wrongAnswer(btn) {
            btn.classList.add('shake-it', 'bg-red-400', 'text-white');
            btn.innerText = "Nope! Try again üòú";
            setTimeout(() => btn.classList.remove('shake-it'), 500);
        }

        function transformButton(btn) {
            btn.classList.remove('border-pink-300', 'text-pink-200');
            btn.classList.add('bg-green-400', 'text-white', 'font-bold', 'border-none');
            btn.innerHTML = "Just be happy! üòÅ";
            btn.onclick = function() { nextQuestion('q2', 'q3'); };
        }

        function nextQuestion(curr, next) {
            document.getElementById(curr).classList.add('hidden');
            document.getElementById(next).classList.remove('hidden');
        }

        function finishQuiz() {
            fireConfetti(0.5); // Burst on finish
            switchSection('step-quiz', 'step-greeting');
        }

        function enterRoom() { switchSection('step-greeting', 'step-room'); }

        // --- Room Interaction ---
        function turnOnLights() {
            document.getElementById('main-body').style.background = "#fff0f5"; // Lavender Blush
            const msg = document.getElementById('room-msg');
            msg.innerText = "Much better! Now let's decorate.";
            msg.classList.remove('text-slate-200');
            msg.classList.add('text-pink-500');

            document.getElementById('bunting').classList.add('visible');
            
            document.getElementById('btn-lights').classList.add('hidden');
            document.getElementById('btn-decor').classList.remove('hidden');
        }

        function decorateRoom() {
            document.getElementById('room-msg').innerText = "Pretty! Now find the cake...";
            
            // Stickers
            const stickers = ['üå∏', '‚ú®', 'üßÅ', 'üíñ', 'üéÄ', 'ü¶Ñ'];
            const container = document.g
